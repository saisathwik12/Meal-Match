<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="login.css">
</head>

<body>
    <header>
        <div id="div3">

            <h1>Login</h1>
            <form action="" id="form1">
                <label for="username">Username</label><br>
                <input type="text" name="username" id="username"><br>
                <label for="password">Password</label><br>
                <input type="password" name="password" id="password"><br>
                <input type="submit" id="submit"><br>
                <div id="anchor">
                    <a id="guest" href="meal.html">Guest Login</a>
                    <a id="register" href="register.html">Register Now?</a>
                </div>
            </form>
            <h3 id="h3"></h3>
        </div>
    </header>
    <script>
        const username1 = document.getElementById("username")
        const password1 = document.getElementById("password")
        const sub = document.getElementById("submit")
        const form1 = document.getElementById("form1")
        const h3 = document.getElementById("h3")

        form1.addEventListener("submit", (e) => {
            e.preventDefault()
            async function fetchget() {
                let user = await fetch("http://localhost:3000/users")
                let get = await user.json()
                console.log(get)
                let found = false
                for (i of get) {
                    let usndata = i.username
                    let passdata = i.password
                    if (username1.value.trim().toLowerCase() === usndata.toLowerCase().trim() && passdata === password1.value) {
                        alert("Login Successful")
                        location.href = "meal.html"
                        found = true
                        break
                    }
                }
                if (!found) {
                    alert("Invalid Username or Password")
                }
            }
            fetchget()


        })


    </script>

</body>

</html>